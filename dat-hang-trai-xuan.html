<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Đặt món hội trại</title>

<style>
body{
  font-family:'Segoe UI',Arial;
  margin:0;
  background:linear-gradient(180deg,#fff,#f2f2f2);
}

nav{
  background:#1f1f1f;
  padding:10px;
  display:flex;
  justify-content:space-around;
  position:sticky;
  top:0;
}

nav button{
  background:none;
  border:none;
  color:#fff;
  font-size:14px;
}

.container{padding:14px}

.card{
  background:#fff;
  padding:16px;
  border-radius:14px;
  margin-bottom:14px;
  box-shadow:0 6px 20px rgba(0,0,0,.12);
}

h2{margin:0 0 10px;font-size:18px}

label{display:block;margin-top:10px;font-weight:600;font-size:14px}

select,input{
  width:100%;
  padding:10px;
  margin-top:4px;
  font-size:14px;
  border-radius:8px;
  border:1px solid #ccc;
}

button{
  width:100%;
  padding:12px;
  margin-top:14px;
  font-size:15px;
  border:none;
  border-radius:10px;
  background:linear-gradient(135deg,#ff5722,#ff784e);
  color:#fff;
  cursor:pointer;
  transition:.15s;
}

button:hover{filter:brightness(1.1);box-shadow:0 6px 14px rgba(0,0,0,.2)}
button:active{transform:scale(.96)}

.hidden{display:none}

.qty{display:flex;gap:12px;justify-content:center;margin-top:8px}
.qty button{width:36px;height:36px;border-radius:50%;padding:0}

table{width:100%;border-collapse:collapse;margin-top:10px;font-size:13px}
th,td{border-bottom:1px solid #ddd;padding:8px}
th{background:#fafafa}

.badge{
  display:inline-block;
  background:#eee;
  padding:4px 8px;
  border-radius:6px;
  font-size:12px;
}
</style>
</head>

<body>

<nav>
<button onclick="showSection('single')">Món lẻ</button>
<button onclick="showSection('combo')">Combo</button>
<button onclick="showSection('cart')">Giỏ hàng</button>
</nav>

<div class="container">

<div class="card">
<h2>Thông tin nhận hàng</h2>
<label>Tên khách *</label><input id="customerName">
<label>Lớp / địa chỉ *</label><input id="classAddress">
<label>Facebook *</label><input id="campName">
<label>Khung giờ *</label>
<select id="pickupTime">
<option value="">-- Chọn --</option>
<option>8:00 – 9:00</option>
<option>9:00 – 10:00</option>
<option>10:00 – 11:00</option>
<option>13:00 – 14:00</option>
<option>14:00 – 15:00</option>
</select>
<button onclick="saveCustomer()">Lưu thông tin</button>
</div>

<div id="single" class="card">
<h2>Món lẻ</h2>
<select id="singleItem" onchange="drinkOpt.classList.toggle('hidden',this.value!=='Trà chanh dây')">
<option disabled selected>Vui lòng chọn món</option>
<option>Gà</option>
<option>Pudding trứng</option>
<option>Pudding hồng trà</option>
<option>Tàu hũ Singapore</option>
<option>Trà chanh dây</option>
</select>

<div id="drinkOpt" class="hidden">
<label>Đá</label><select id="singleIce"><option>Đá bình thường</option><option>Ít đá</option><option>Không đá</option></select>
<label>Thạch</label><select id="singleJelly"><option>Thạch bình thường</option><option>Không thạch</option></select>
</div>

<div class="qty">
<button onclick="changeQty('singleQty',-1)">-</button>
<input id="singleQty" value="1">
<button onclick="changeQty('singleQty',1)">+</button>
</div>

<button onclick="addSingle()">Thêm</button>
</div>

<div id="combo" class="card hidden">
<h2>Combo</h2>
<select id="comboType" onchange="renderCombo()">
<option disabled selected>Vui lòng chọn combo</option>
<option>Combo 1</option>
<option>Combo 2</option>
<option>Combo 3</option>
</select>
<div id="comboOpt"></div>

<div class="qty">
<button onclick="changeQty('comboQty',-1)">-</button>
<input id="comboQty" value="1">
<button onclick="changeQty('comboQty',1)">+</button>
</div>

<button onclick="addCombo()">Thêm combo</button>
</div>

<div id="cart" class="card hidden">
<h2>Giỏ hàng</h2>
<table>
<thead><tr><th>Loại</th><th>Chi tiết</th><th>SL</th><th></th></tr></thead>
<tbody id="cartTable"></tbody>
</table>
<button onclick="submitCart()">Xác nhận đặt</button>
</div>

</div>

<script>
const SHEET_URL='https://script.google.com/macros/s/AKfycbzYLb8O-4o7SGVqkOnfIek64JWObVcE88m8VV30mXakf0j0sjrsd_gZUeJt_5W9zUb0YQ/exec';
let cart=[];

function showSection(id){
['single','combo','cart'].forEach(s=>document.getElementById(s).classList.add('hidden'));
document.getElementById(id).classList.remove('hidden');
if(id==='cart') renderCart();
}

function saveCustomer(){
localStorage.setItem('customer',JSON.stringify({
ten:customerName.value,
lop:classAddress.value,
trai:campName.value,
gio:pickupTime.value
}));
alert('Đã lưu');
}

function changeQty(id,d){
const i=document.getElementById(id);
i.value=Math.max(1,Number(i.value)+d);
}

function renderCombo(){
comboOpt.innerHTML='';
if(comboType.value!=='Combo 2'){
comboOpt.innerHTML+=`
<label>Đá</label><select id="cIce"><option>Đá bình thường</option><option>Ít đá</option><option>Không đá</option></select>
<label>Thạch</label><select id="cJelly"><option>Thạch bình thường</option><option>Không thạch</option></select>`;
}
comboOpt.innerHTML+=`
<label>Tráng miệng 1</label><select id="d1"><option>Pudding trứng</option><option>Pudding hồng trà</option><option>Tàu hũ Singapore</option></select>`;
if(comboType.value==='Combo 2'){
comboOpt.innerHTML+=`
<label>Tráng miệng 2</label><select id="d2"><option>Pudding trứng</option><option>Pudding hồng trà</option><option>Tàu hũ Singapore</option></select>`;
}
}

function addSingle(){
cart.push({loai:'Món lẻ',noiDung:singleItem.value,soLuong:singleQty.value});
alert('Đã thêm');
}

function addCombo(){
const desserts=[d1.value];
if(window.d2) desserts.push(d2.value);
cart.push({
loai:'Combo',
noiDung:comboType.value,
chiTiet:{
trangmieng:desserts,
da:window.cIce?.value||'',
thach:window.cJelly?.value||''
},
soLuong:comboQty.value
});
alert('Đã thêm combo');
}

function renderCart(){
cartTable.innerHTML='';
cart.forEach((c,i)=>{
cartTable.innerHTML+=`
<tr>
<td>${c.loai}</td>
<td>
<b>${c.noiDung}</b><br>
<span class="badge">Tráng miệng: ${c.chiTiet?.trangmieng.join(', ')||''}</span><br>
${c.chiTiet?.da?`<span class="badge">Nước: ${c.chiTiet.da}, ${c.chiTiet.thach}</span>`:''}
</td>
<td>${c.soLuong}</td>
<td><button onclick="cart.splice(${i},1);renderCart()">Xóa</button></td>
</tr>`;
});
}

function submitCart(){
const customer=JSON.parse(localStorage.getItem('customer'));
fetch(SHEET_URL,{
method:'POST',
mode:'no-cors',
body:JSON.stringify({customer,cart})
}).then(()=>{
localStorage.clear();
cart=[];
location.href='thankyou.html';
});
}
</script>

</body>
</html>



